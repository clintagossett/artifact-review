# Next.js Runtime Configuration
# Copy to .env.nextjs.local and fill in your values
#
# NOTE: Agent identity (AGENT_NAME, ports, domains) is in ../.env.docker.local
# This file contains secrets and runtime config for the Next.js app.

# =============================================================================
# CONVEX CONNECTION
# =============================================================================
# Self-Hosted Convex (Docker) - Server-side for CLI tools
# Uses localhost because CLI runs on host, not in container
CONVEX_SELF_HOSTED_URL=http://127.0.0.1:3220

# Admin key - auto-generated by setup script
# CONVEX_SELF_HOSTED_ADMIN_KEY=

# Browser-side Convex URLs (use DNS names for orchestrator proxy routing)
# These should match your AGENT_NAME in ../.env.docker.local
# Sync/WebSocket - mirrors *.convex.cloud
NEXT_PUBLIC_CONVEX_URL=https://${AGENT_NAME}.convex.cloud.loc
# HTTP actions/storage - mirrors *.convex.site
NEXT_PUBLIC_CONVEX_HTTP_URL=https://${AGENT_NAME}.convex.site.loc

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================
# Internal API key for server-to-server calls
# Generate with: openssl rand -hex 32
INTERNAL_API_KEY=

# Site URL (used for auth emails, links, etc.)
# Should match SITE_URL in ../.env.docker.local
SITE_URL=https://${AGENT_NAME}.loc

# Convex Site URL (for auth send-auth-email action)
CONVEX_SITE_URL=https://${AGENT_NAME}.convex.site.loc

# =============================================================================
# EMAIL (RESEND)
# =============================================================================
# Full access key for email retrieval in tests
# Get from: https://resend.com/api-keys
# For local dev, use the dummy key below (Mailpit is used instead)
# For hosted environments, replace with real Resend API key
RESEND_FULL_ACCESS_API_KEY=re_dummy_key_for_localhost

# Email sender addresses
EMAIL_FROM_AUTH="Artifact Review <auth@artifactreview-early.xyz>"
EMAIL_FROM_NOTIFICATIONS="Artifact Review <notify@artifactreview-early.xyz>"

# =============================================================================
# NOTIFICATIONS (NOVU)
# =============================================================================
# Run ./scripts/setup-novu-org.sh to auto-configure these
# Or get manually from: https://novu.loc → Settings → API Keys
NOVU_SECRET_KEY=
NEXT_PUBLIC_NOVU_APPLICATION_IDENTIFIER=
NOVU_API_URL=https://api.novu.loc
NEXT_PUBLIC_NOVU_API_URL=https://api.novu.loc
NEXT_PUBLIC_NOVU_SOCKET_URL=wss://ws.novu.loc

# Digest interval for batching notifications before sending email
# ⚠️ This is a NEXT.JS variable (read by the Novu bridge API route).
#    Do NOT set this in .env.convex.local — Convex does not use it.
#    For hosted environments, set as a Vercel env var.
# Format: <number><unit> where unit is s/m/h (seconds/minutes/hours)
# Local: 30s, Staging: 2m (Vercel), Production: 20m (Vercel)
NOVU_DIGEST_INTERVAL=30s

# =============================================================================
# LOCAL DEV TOOLS
# =============================================================================
# Mailpit API URL (local email testing)
MAILPIT_API_URL=https://${AGENT_NAME}.mailpit.loc/api/v1

# =============================================================================
# TLS CERTIFICATES (for HTTPS testing with mkcert)
# =============================================================================
# Required for Playwright tests to trust local mkcert CA certificates.
# Without this, HTTPS requests to *.loc domains will fail with certificate errors.
# Find your mkcert CA root path with: mkcert -CAROOT
NODE_EXTRA_CA_CERTS=/home/YOUR_USERNAME/.local/share/mkcert/rootCA.pem
