# Environment Variables Audit

This document is the **authoritative source** for all environment variables used in the Artifact Review application. It lists variables required for both the Frontend (Next.js) and Backend (Convex).

## 1. Backend Variables (Convex Dashboard)

These variables must be set in the **Convex Dashboard** under **Project Settings** -> **Environment Variables**. They are accessible by your backend code (`convex/`).

### üö® Critical
| Variable Name | Description | Used In Files |
| :--- | :--- | :--- |
| `INTERNAL_API_KEY` | **Secret Key**. Authenticates the internal bridge between Auth.js and Convex. Must be a strong random string. | `convex/http.ts`, `convex/auth.ts` |
| `RESEND_API_KEY` | **Secret Key**. Your Resend API Key (starts with `re_`). <br><br> **Security Note:**<br> - **Local Dev (`.env.local`)**: Use **Full Access Key** (Required for E2E tests to read/verify emails).<br> - **Hosted (Dashboard)**: Use **Sending Only Key** (Best practice for security). | `convex/http.ts`, `convex/checkEnv.ts`, coverage in `tests/e2e/utils/resend.ts` |
| `SITE_URL` | **Configuration**. The public URL of your Frontend (e.g., `https://artifactreview.com`). Used for redirects. | `convex/checkEnv.ts` |
| `JWT_PRIVATE_KEY` | **Auth Key**. Private key for signing authentication tokens. (Generated by `generateKeys.mjs`). | `@convex-dev/auth` |
| `JWKS` | **Auth Key**. Public key set for verifying tokens. (Generated by `generateKeys.mjs`). | `@convex-dev/auth` |

### üìß Email Configuration
| Variable Name | Description | Used In Files |
| :--- | :--- | :--- |
| `EMAIL_FROM_AUTH` | **Sender Address**. The "From" address for magic link emails (e.g., `Auth <auth@domain.com>`). | `convex/http.ts` |
| `EMAIL_FROM_NOTIFICATIONS` | **Sender Address**. The "From" address for invitation emails (e.g., `Notify <notify@domain.com>`). | `convex/access.ts` |

### ‚ÑπÔ∏è Optional / Development
| Variable Name | Description | Default | Used In Files |
| :--- | :--- | :--- | :--- |
| `SKIP_EMAILS` | Set to `"true"` to suppress all email sending. Useful for seed scripts or local dev. | `false` | `convex/access.ts` |
| `RESEND_TEST_MODE` | Set to `"false"` to send *real* emails. Defaults to `"true"` (safe mode). | `true` | `convex/lib/resend.ts` |
| `LOG_LEVEL` | Logging verbosity: `debug`, `info`, `warn`, `error`. | `debug` | `convex/lib/logger.ts` |

### üîí System Variables (Managed by Convex)
| Variable Name | Description |
| :--- | :--- |
| `CONVEX_SITE_URL` | The public URL of your Convex Deployment HTTP actions. Automatically set by Convex. Used in `convex/auth.ts` and `convex/auth.config.ts`. |

---

## 2. Frontend Variables (.env.local / Vercel)

These variables must be set in your local `.env.local` file and in your Frontend Hosting Provider (e.g., Vercel, Netlify). They are exposed to the browser.

### üö® Critical
| Variable Name | Description | Used In Files |
| :--- | :--- | :--- |
| `NEXT_PUBLIC_CONVEX_URL` | **Configuration**. The URL of your Convex Backend (e.g., `https://mild-ptarmigan-109.convex.cloud`). | `src/components/ConvexClientProvider.tsx` |
| `NEXT_PUBLIC_CONVEX_HTTP_URL` | **Configuration**. The HTTP Actions URL of your Convex Backend (e.g., `https://mild-ptarmigan-109.convex.site`). Used for proxying artifacts. | `src/app/api/artifact/.../route.ts` |

### ‚ÑπÔ∏è Optional
| Variable Name | Description | Default |
| :--- | :--- | :--- |
| `NEXT_PUBLIC_LOG_LEVEL` | Frontend logging verbosity: `debug`, `info`, `warn`, `error`. | `debug` |

---

## 3. Local Development (`.env.local`)

For local development, your `.env.local` file should look like this:

```bash
# Deployment used by npx convex dev
CONVEX_DEPLOYMENT=...

# Frontend Config
NEXT_PUBLIC_CONVEX_URL=https://...
NEXT_PUBLIC_CONVEX_HTTP_URL=https://...

# Backend Config (Keys must match what you set in Dashboard)
INTERNAL_API_KEY=...
RESEND_API_KEY=...

# Email Config
EMAIL_FROM_AUTH="Auth <auth@test.com>"
EMAIL_FROM_NOTIFICATIONS="Notify <notify@test.com>"
```

## 4. Standard Runtime Variables

The following are standard Node.js/CI variables used by the system. You generally do not need to set these manually.

| Variable Name | Description | Used In Files |
| :--- | :--- | :--- |
| `NODE_ENV` | Environment mode: `development`, `production`, or `test`. | Used throughout app for environment-specific logic. |
| `CI` | Continuous Integration flag. Set to `true` in CI environments (e.g., GitHub Actions). | `playwright.config.ts` |

## 5. Build & Deployment Variables (Vercel Project Settings)
These variables are used during the build process on Vercel to deploy your Convex functions.

| Variable Name | Description | Used By |
| :--- | :--- | :--- |
| `CONVEX_DEPLOY_KEY` | **Secret Key**. Authenticates Vercel to deploy your Convex functions. Found in Convex Dashboard -> Project Settings -> Deploy Keys. | `npx convex deploy` (Vercel Build Command) |

